-*- mode: org -*-
* Introduction
This README documents setting up Arch Linux on an vipus.com openvz
* Step by Step [12/12]
1. [ ] Install Arch Linux ([[http://manage.virpus.com/login.php]])
2. [ ] Set root password
3. [ ] To facilitate upgrading glibc, add [openvz-tdw] repository to /etc/pacman.conf
       [openvz-tdw]
       Server = http://packages.shilohsystem.com/openvz-tdw/i686
       Server = http://packages.shilohsystem.com/openvz-tdw/x86_64
4. [ ] Run "pacman -Sy" to refresh package lists
5. [ ] Run "pacman -S pacman" to upgrade pacman
6. [ ] Run "pacman-db-upgrade" to update the pacman database format
7. [ ] Copy /etc/pacman.conf.pacnew to /etc/pacman.conf
8. [ ] Add [openvz-tdw] repository again to the new /etc/pacman.conf as in step 3
9. [ ] Run "pacman -Sy" again to refresh package lists
10. [ ] Run "pacman -S --force initscripts" to upgrade the initscripts package
	( See https://www.archlinux.org/news/initscripts-update-manual-intervention-required/ for details )
11. [ ] Run "pacman -S --force filesystem" to upgrade the filesystem package
	( See http://www.archlinux.org/news/filesystem-upgrade-manual-intervention-required/ for details )
12. [ ] Run "pacman -Su" to upgrade the system
13. [ ] Run "pacman -S inetutils"
* Upgrading glibc
** Primary documentation
1. [[http://wiki.openvz.org/Archlinux_Template_creation][http://wiki.openvz.org/Archlinux_Template_creation]]
2. [[https://wiki.archlinux.org/index.php/VPS#Old_kernel_and_a_broken_system_with_OpenVZ][https://wiki.archlinux.org/index.php/VPS#Old_kernel_and_a_broken_system_with_OpenVZ]]
3. [[https://bbs.archlinux.org/viewtopic.php?pid=1044707][https://bbs.archlinux.org/viewtopic.php?pid=1044707]]
** Secondary documentation
1. [[http://wiki.gotux.net/archlinux/tutorials/openvz-vps-install][http://wiki.gotux.net/archlinux/tutorials/openvz-vps-install]]
* Developer Notes
** How to make a glibc package
*** Steps
1. [ ] install abs (pacman --sync abs)
2. [ ] run abs ( /usr/bin/abs )
3. [ ] copy /var/abs/glibc to a build directory
4. [ ] change pkgrel variable in PKGBUILD
5. [ ] change --enable-kernel flag in PKGBUILD to 2.6.18
6. [ ] run makepkg PKGBUILD
** How to set up a custom repository
[openvz-tdw]
Server = http://packages.shilohsystem.com/openvz-tdw
mkdir /srv/http/packages/openvz-tdw
#+begin_src sh
#!/bin/sh
PATH_TO_DB="/srv/http/packages/openvz-tdw/openvz-tdw.db.tar.gz"
PACKAGE="/srv/http/packages/openvz-tdw/glibc-2.15-100-i686.pkg.tar.xz"
repo-add ${PATH_TO_DB} ${PACKAGE}
#+end_src
==> Adding package '/srv/http/packages/openvz-tdw/glibc-2.15-100-i686.pkg.tar.xz'
  -> Computing checksums...
  -> Creating 'desc' db entry...
  -> Creating 'depends' db entry...
==> Creating updated database file '/srv/http/packages/openvz-tdw/openvz-tdw.db.tar.gz'

1. repo-add /srv/http/packages/openvz/glibc-vps/i686/glibc-openvz.db.tar.gz i686/glibc-2.15-10-i686.pkg.tar.xz
